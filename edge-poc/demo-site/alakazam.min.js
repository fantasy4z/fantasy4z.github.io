var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,f){a!=Array.prototype&&a!=Object.prototype&&(a[c]=f.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(f){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(f||"")+"_"+c++,f)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var f=0,b={next:function(){if(f<a.length){var e=f++;return{value:c(e,a[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,c,f,b){if(c){f=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var e=a[b];e in f||(f[e]={});f=f[e]}a=a[a.length-1];b=f[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(f,b,e){return f==a&&"q"==b&&e==c}}));return!0===c.q}catch(f){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(p){return!1}}function f(){}function b(a){var b=typeof a;return"object"===b&&null!==a||"function"===b}function e(a){if(!$jscomp.owns(a,d)){var b=new f;$jscomp.defineProperty(a,d,{value:b})}}function g(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
f)return a;e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var d="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var r=0,k=function(a){this.id_=(r+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,c){if(!b(a))throw Error("Invalid WeakMap key");e(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+
a);a[d][this.id_]=c;return this};k.prototype.get=function(a){return b(a)&&$jscomp.owns(a,d)?a[d][this.id_]:void 0};k.prototype.has=function(a){return b(a)&&$jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};k.prototype.delete=function(a){return b(a)&&$jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),e=c.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var f=new WeakMap,b=function(a){this.data_={};this.head_=d();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};b.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};b.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};b.prototype.has=function(a){return!!e(this,a).entry};
b.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};b.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};b.prototype.keys=function(){return g(this,function(a){return a.key})};b.prototype.values=function(){return g(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?f.has(b)?d=f.get(b):(d=""+ ++r,f.set(b,d)):d="p_"+b;var c=a.data_[d];if(c&&$jscomp.owns(a.data_,d))for(a=0;a<c.length;a++){var e=c[a];if(b!==b&&e.key!==e.key||b===e.key)return{id:d,list:c,index:a,entry:e}}return{id:d,list:c,index:-1,entry:void 0}},g=function(a,b){var d=a.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=a.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:b(d)};d=null}return{done:!0,value:void 0}})},d=function(){var a={};return a.previous=
a.next=a.head=a},r=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),d=f.next();if(d.done||d.value[0]!=b||d.value[1]!=b)return!1;d=f.next();return d.done||d.value[0]==b||4!=d.value[0].x||d.value[1]!=d.value[0]?!1:f.next().done}catch(r){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var f=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};f.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};f.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};f.prototype.clear=function(){this.map_.clear();
this.size=0};f.prototype.has=function(a){return this.map_.has(a)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(a,c){var b=this;this.map_.forEach(function(d){return a.call(c,d,d,b)})};return f},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function c(){this.batch_=null}function f(a){return a instanceof e?a:new e(function(b,d){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var b=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(a){b(a,0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};c.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var g=new c;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(h){c.reject(h)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(l){f(l)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=f;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,c){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())f(e.value).callWhenSettled_(b,
c)})};e.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?f([]):new e(function(a,d){function e(b){return function(c){g[b]=c;n--;0==n&&a(g)}}var g=[],n=0;do g.push(void 0),n++,f(c.value).callWhenSettled_(e(g.length-1),d),c=b.next();while(!c.done)})};return e},"es6","es3");$jscomp.findInternal=function(a,c,f){a instanceof String&&(a=String(a));for(var b=a.length,e=0;e<b;e++){var g=a[e];if(c.call(f,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,f){return $jscomp.findInternal(this,a,f).v}},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,c){for(var f=1;f<arguments.length;f++){var b=arguments[f];if(b)for(var e in b)$jscomp.owns(b,e)&&(a[e]=b[e])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,f,b){f=null!=f?f:function(a){return a};var c=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof g){a=g.call(a);for(var d=0;!(g=a.next()).done;)c.push(f.call(b,g.value,d++))}else for(g=a.length,d=0;d<g;d++)c.push(f.call(b,a[d],d));return c}},"es6","es3");$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(f){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.polyfill("Object.setPrototypeOf",function(a){return a||$jscomp.setPrototypeOf},"es6","es5");
require=function(){function a(c,f,b){function e(d,k){if(!f[d]){if(!c[d]){var h="function"==typeof require&&require;if(!k&&h)return h(d,!0);if(g)return g(d,!0);k=Error("Cannot find module '"+d+"'");throw k.code="MODULE_NOT_FOUND",k;}k=f[d]={exports:{}};c[d][0].call(k.exports,function(a){return e(c[d][1][a]||a)},k,k.exports,a,c,f,b)}return f[d].exports}for(var g="function"==typeof require&&require,d=0;d<b.length;d++)e(b[d]);return e}return a}()({1:[function(a,c,f){c=a("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var b=c(a("@babel/runtime/helpers/toConsumableArray"));f["default"]={sdpSemantics:"unified-plan",iceServers:[{urls:"stun:stun.l.google.com:19302 stun:stun1.l.google.com:19302 stun:stun2.l.google.com:19302 stun:stun3.l.google.com:19302 stun:stun4.l.google.com:19302 stun:stun.l.google.com:19302?transport=udp".split(" ")}],additionalIceServers:[{urls:["turn:3.114.87.93:80"],username:"kaios",credential:"kaiedge2019"}],iceTransportPolicy:"all",
useBlastoise:!0,HOST:"http://a64da2e60ef3111e986880ec6c8a69cf-34fbe75a58277cd3.elb.ap-northeast-1.amazonaws.com/blastoise/",getDefaultRtcConfiguration:function(){return{sdpSemantics:this.sdpSemantics,iceServers:[].concat((0,b["default"])(this.iceServers),(0,b["default"])(this.additionalIceServers)),iceTransportPolicy:this.iceTransportPolicy}}}},{"@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault","@babel/runtime/helpers/toConsumableArray":"@babel/runtime/helpers/toConsumableArray"}],
2:[function(a,c,f){function b(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,d)}return c}function e(a){for(var c=1;c<arguments.length;c++){var d=null!=arguments[c]?arguments[c]:{};c%2?b(d,!0).forEach(function(b){(0,p["default"])(a,b,d[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(d)):b(d).forEach(function(b){Object.defineProperty(a,
b,Object.getOwnPropertyDescriptor(d,b))})}return a}function g(a,b){for(var c in b){var e=a[c],f=b[c];try{a[c]=e&&"object"===(0,l["default"])(f)?g(e,f):d(f)}catch(L){return b}}return a}function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;if(!a||"object"!==(0,l["default"])(a)||0==Object.keys(a).length)return a;if(b.has(a))return"ignore";b.add(a);var c={},e;for(e in a)c[e]=d(a[e],b);return c}function r(a){a=a.map(function(a){return d(a)});return JSON.stringify(a,function(a,
b){return b instanceof Node?"Node":b instanceof Window?"Window":b})}c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var k=c(a("@babel/runtime/helpers/slicedToArray")),h=c(a("@babel/runtime/helpers/toConsumableArray")),q=c(a("@babel/runtime/regenerator")),u=c(a("@babel/runtime/helpers/asyncToGenerator")),p=c(a("@babel/runtime/helpers/defineProperty")),n=c(a("@babel/runtime/helpers/classCallCheck")),t=c(a("@babel/runtime/helpers/createClass")),
l=c(a("@babel/runtime/helpers/typeof")),w=c(a("./config.server.js")),E=c(a("./signaling_gengar.js")),F=c(a("./signaling_blastoise.js")),B=c(a("./webrtc_event.js")),y=window.RTCPeerConnection,v=window.RTCSessionDescription;a=function(){function a(){var b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,n["default"])(this,a);this.options=e({},w["default"],{host:w["default"].HOST,videoResizePercentage:1,prefix:"webrtc",user_params:{},onReady:function(){}},c);this.listener=new Map;
this.options.mediaElement.addEventListener("resize",function(){var a=b.options,c=a.mediaElement;a=a.videoResizePercentage;c.style.width="".concat(c.videoWidth*a,"px");c.style.height="".concat(c.videoHeight*a,"px")});this.tracks=[];this.addEventListener("edgealert",alert)}(0,t["default"])(a,[{key:"_processSignaling",value:function(){var a=(0,u["default"])(q["default"].mark(function D(){var a=this,b,c,d,f,l,g,M,N,n,p,t,z,k,u,h,r,x,w=arguments;return q["default"].wrap(function(m){for(;;)switch(m.prev=
m.next){case 0:return b=0<w.length&&void 0!==w[0]?w[0]:{},c=1<w.length&&void 0!==w[1]?w[1]:null,d=b.useBlastoise?F["default"]:E["default"],f=y,l=e({beforeAnswer:function(){},afterAnswer:function(){},stereo:!0},b),g=l.beforeAnswer,M=l.afterAnswer,N=l.stereo,n=l.user_params,p=l.host,t=l.prefix,this.signaling&&(!b.useBlastoise||this.signaling instanceof F["default"])&&(b.useBlastoise||this.signaling instanceof E["default"])||(this.signaling=new d(p,t)),m.next=8,this.signaling.createConnection(n);case 8:z=
m.sent;k=z.id;u=z.app_id;this.getId=function(){return k};this.getAppId=function(){return u};if(!c){m.next=16;break}h=c;m.next=22;break;case 16:return h=new f(this.options.getDefaultRtcConfiguration()),h.addEventListener("connectionstatechange",function(){"closed"==h.connectionState&&a.signaling.closeConnection(k);if("failed"===h.connectionState)throw Error("peerconnection failed");}),h.addEventListener("signalingstatechange",function(){"closed"==h.signalingState&&a.signaling.closeConnection(k)}),
h.addEventListener("icecandidate",function(b){a.signaling.addIceCandidate(k,b.candidate)}),m.next=22,g(h);case 22:return m.prev=22,r=new v(z.localDescription),m.next=26,h.setRemoteDescription(r);case 26:return m.next=28,h.createAnswer();case 28:return x=m.sent,N&&(x.sdp=x.sdp.replace(/a=fmtp:111/,"a=fmtp:111 stereo=1\r\na=fmtp:111")),m.next=32,h.setLocalDescription(x);case 32:return m.next=34,this.signaling.setRemoteDescription(k,h.localDescription);case 34:return m.next=36,M(h);case 36:m.next=42;
break;case 38:throw m.prev=38,m.t0=m["catch"](22),h.close(),m.t0;case 42:return m.abrupt("return",h);case 43:case "end":return m.stop()}},D,this,[[22,38]])}));return function(){return a.apply(this,arguments)}}()},{key:"addEventListener",value:function(a,b){this.listener.has(a)||this.listener.set(a,[]);this.listener.get(a).push(b)}},{key:"removeEventListener",value:function(a,b){if(this.listener.has(a)){var c=this.listener.get(a).filter(function(a){return a!=b});this.listener.set(a,c);0==c.length&&
this.send("unlisten_event ".concat(a))}}},{key:"emit",value:function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this.send("event ".concat(a," ").concat(r(c)))}},{key:"postMessage",value:function(a){this.send("msg ".concat(a))}},{key:"onMessage",value:function(a){this._messageCB=a}},{key:"_processEventMessage",value:function(a,b){if(this.listener.has(a)){var c=JSON.parse(b);this.listener.get(a).forEach(function(a){return a.apply(void 0,(0,h["default"])(c))})}}},
{key:"_processOnMessage",value:function(a){this._messageCB&&this._messageCB(a)}},{key:"getNowMs",value:function(){return(new Date|0).toFixed(1)}},{key:"ping",value:function(){var a=this,b={};b.promise=new Promise(function(a,c){b.resolve=a;b.reject=c});b.timeout=setTimeout(function(){return b.reject("timeout ".concat(2E3,"ms"))},2E3);b.cleanup=function(){return clearTimeout(a.pong.timeout)};this.pong&&(this.pong.reject("canceled"),this.pong.cleanup(),this.pong=null);b.ping=this.getNowMs();this.send("ping "+
b.ping);this.pong=b;return b.promise}},{key:"_processPong",value:function(a){this.pong&&(this.pong.ping==a?this.pong.resolve(this.getNowMs()-a):this.pong.reject("mismatched"),this.pong.cleanup(),this.pong=null)}},{key:"resize",value:function(a,b){this.send("resize ".concat(a," ").concat(b))}},{key:"goto",value:function(a){this.send("goto ".concat(a))}},{key:"back",value:function(){this.send("back")}},{key:"forward",value:function(){this.send("forward")}},{key:"reload",value:function(){this.send("reload")}},
{key:"inputString",value:function(a){this.send("string ".concat(a))}},{key:"inputKeyCode",value:function(a,b){this.send("key_code ".concat(a," ").concat(b?1:0))}},{key:"beforeAnswer",value:function(){var a=(0,u["default"])(q["default"].mark(function K(a){var b=this,c,d;return q["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.peerConnection=a,a.ondatachannel=function(c){var d=c.channel;b.dataChannel=d;d.onopen=function(a){b.listener.forEach(function(a,b){d.send("listen_event ".concat(b))});
b.options.onReady()};d.onmessage=function(c){c=c.data;var d=c.split(" ",2),e=(0,k["default"])(d,2);d=e[0];e=e[1];switch(d){case "event":return b._processEventMessage(e,c.substr(d.length+e.length+2));case "msg":return b._processOnMessage(c.substr(d.length+1));case "renegotiation":return b._processSignaling(b.options,a);case "pong":return b._processPong(e);default:console.log("unhandle message",c)}}},this.options.localMedia&&(c=this.options.localMedia,d=c.getTracks(),d.forEach(function(b){return a.addTrack(b,
c)})),a.addEventListener("track",function(a){a=a.receiver.track;b.tracks["video"==a.kind?0:1]=a;b.options.mediaElement.srcObject=new MediaStream(b.tracks)});case 4:case "end":return e.stop()}},K,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"connect",value:function(){var a=(0,u["default"])(q["default"].mark(function D(){var a,b,c=arguments;return q["default"].wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=0<c.length&&void 0!==c[0]?c[0]:{},g(this.options,a),this.disconnect(),
d.next=5,this._processSignaling(e({},this.options,{beforeAnswer:this.beforeAnswer.bind(this)}));case 5:return b=d.sent,d.abrupt("return",b);case 7:case "end":return d.stop()}},D,this)}));return function(){return a.apply(this,arguments)}}()},{key:"disconnect",value:function(){this.signaling&&(this.signaling.id=-1);this.peerConnection&&this.peerConnection.close();this.dataChannel=this.peerConnection=null}},{key:"getPeer",value:function(){return this.peerConnection}},{key:"send",value:function(a){this.dataChannel&&
this.dataChannel.send(a)}},{key:"replaceVideoTrack",value:function(a){var b=this.peerConnection.getSenders().find(function(b){return b.track.kind==a.kind});return b.track!=a?(b.replaceTrack(a),b.track):{stop:function(){}}}}],[{key:"createClient",value:function(b){var c=new a(b),d=null,f=c.connect,l=c.disconnect;c.connect=(0,u["default"])(q["default"].mark(function A(){var a,b,l,g,n=arguments;return q["default"].wrap(function(m){for(;;)switch(m.prev=m.next){case 0:a=n.length;b=Array(a);for(l=0;l<a;l++)b[l]=
n[l];m.next=3;return f.apply(c,b);case 3:return g=m.sent,d=B["default"].listen(e({connectionClient:c},c.options)),m.abrupt("return",g);case 6:case "end":return m.stop()}},A)}));c.disconnect=function(){d&&(d.unlisten(),d=null);l.apply(c)};return c}}]);return a}();f["default"]=a},{"./config.server.js":1,"./signaling_blastoise.js":8,"./signaling_gengar.js":9,"./webrtc_event.js":10,"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/classCallCheck":"@babel/runtime/helpers/classCallCheck",
"@babel/runtime/helpers/createClass":"@babel/runtime/helpers/createClass","@babel/runtime/helpers/defineProperty":"@babel/runtime/helpers/defineProperty","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault","@babel/runtime/helpers/slicedToArray":"@babel/runtime/helpers/slicedToArray","@babel/runtime/helpers/toConsumableArray":"@babel/runtime/helpers/toConsumableArray","@babel/runtime/helpers/typeof":"@babel/runtime/helpers/typeof","@babel/runtime/regenerator":"@babel/runtime/regenerator"}],
3:[function(a,c,f){function b(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,d)}return c}function e(a){for(var c=1;c<arguments.length;c++){var d=null!=arguments[c]?arguments[c]:{};c%2?b(d,!0).forEach(function(b){(0,g["default"])(a,b,d[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(d)):b(d).forEach(function(b){Object.defineProperty(a,
b,Object.getOwnPropertyDescriptor(d,b))})}return a}c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var g=c(a("@babel/runtime/helpers/defineProperty")),d=c(a("@babel/runtime/regenerator")),r=c(a("@babel/runtime/helpers/asyncToGenerator")),k=c(a("@babel/runtime/helpers/classCallCheck")),h=c(a("@babel/runtime/helpers/createClass")),q=c(a("./dummy_stream.js"));a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?
arguments[0]:240,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:320;(0,k["default"])(this,a);if(!navigator.mediaDevices)throw"no navigator.mediaDevices available, no permission?";this.constraints_={audio:!1,video:{width:{ideal:b},height:{ideal:c},facingMode:"user"}};this.state=0;this.supportFlip=!0===navigator.mediaDevices.getSupportedConstraints().facingMode}(0,h["default"])(a,[{key:"connect",value:function(){var a=(0,r["default"])(d["default"].mark(function l(a){var b;return d["default"].wrap(function(c){for(;;)switch(c.prev=
c.next){case 0:return this.state=a,this.constraints_.video.facingMode=1==a?"user":{exact:"environment"},c.prev=2,this.stream&&(b=this.stream.getTracks()[0],b.stop(),this.stream=null),c.next=6,navigator.mediaDevices.getUserMedia(this.constraints_);case 6:this.stream=c.sent;c.next=12;break;case 9:c.prev=9,c.t0=c["catch"](2),console.error("connect error",c.t0);case 12:case "end":return c.stop()}},l,this,[[2,9]])}));return function(b){return a.apply(this,arguments)}}()},{key:"getMediaStream",value:function(){return this.stream}},
{key:"disconnect",value:function(){this.state=0;this.stream&&(this.stream.getVideoTracks().forEach(function(a){return a.stop()}),this.stream=null)}},{key:"setSize",value:function(a,b){var c=this.constraints_.video;if(a!=c.width.ideal||b!=c.height.ideal)this.disconnect(),c.width.ideal=a,c.height.ideal=b}},{key:"connectFrontCamera",value:function(){var a=(0,r["default"])(d["default"].mark(function t(){return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(1!=this.state){a.next=
2;break}return a.abrupt("return");case 2:return a.next=4,this.connect(1);case 4:return a.abrupt("return",this.getMediaStream());case 5:case "end":return a.stop()}},t,this)}));return function(){return a.apply(this,arguments)}}()},{key:"connectBackCamera",value:function(){var a=(0,r["default"])(d["default"].mark(function t(){return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(2!=this.state){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,this.connect(2);case 4:return a.abrupt("return",
this.getMediaStream());case 5:case "end":return a.stop()}},t,this)}));return function(){return a.apply(this,arguments)}}()},{key:"connectFlipCamera",value:function(){return this.supportFlip?2==this.state?this.connectFrontCamera():this.connectBackCamera():this.getMediaStream()}},{key:"supportFlip",value:function(){return this.supportFlip}},{key:"isFront",value:function(){return 1==this.state}}],[{key:"hookConnection",value:function(b){var c=b.connectionClient,f=new a(b.width,b.height),l=c.connect,
g,h;c.connect=function(){var a=(0,r["default"])(d["default"].mark(function z(a){var b,k,p,n,r,t=arguments;return d["default"].wrap(function(d){for(;;)switch(d.prev=d.next){case 0:try{h.stop()}catch(I){}b=t.length;k=Array(1<b?b-1:0);for(p=1;p<b;p++)k[p-1]=t[p];d.next=5;return l.apply(c,[e({},a,{localMedia:q["default"].blackSteam()})].concat(k));case 5:return n=g=d.sent,r=function m(){if("disconnected"===n.iceConnectionState||"closed"===n.iceConnectionState||"failed"===n.iceConnectionState)n.removeEventListener("iceconnectionstatechange",
m),f.disconnect()},n.addEventListener("iceconnectionstatechange",r),d.abrupt("return",g);case 10:case "end":return d.stop()}},z)}));return function(b){return a.apply(this,arguments)}}();var k=function(a){try{c.replaceVideoTrack(a).stop()}catch(v){console.error("fail to replaceTrack(), stop all.",v),a.stop()}},p=function(a,b,d){c.emit("camerareponse",{id:a,success:b,message:d,data:3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}})};c.addEventListener("camerarequest",function(){var a=(0,r["default"])(d["default"].mark(function z(a){var b,
e,l,g,k,h;return d["default"].wrap(function(d){for(;;)switch(d.prev=d.next){case 0:b=a.id;e=a.type;l=a.data;if("open"!=e){d.next=20;break}g=l.width;k=l.height;h=l.front;d.prev=3;f.setSize(g,k);if(!h){d.next=10;break}d.next=8;return c.openFrontCamera();case 8:d.next=12;break;case 10:return d.next=12,c.openBackCamera();case 12:p(b,!0,"Open ".concat(g,"x").concat(k,", front:").concat(h|0));d.next=18;break;case 15:d.prev=15,d.t0=d["catch"](3),p(b,!1,"Fail to open ".concat(g,"x").concat(k,", front:").concat(h|
0));case 18:d.next=21;break;case 20:"close"==e?(c.closeCamera(),p(b,!0,"Closed")):p(b,!1,"unkonw command ".concat(b,".").concat(e));case 21:case "end":return d.stop()}},z,null,[[3,15]])}));return function(b){return a.apply(this,arguments)}}());c.openFrontCamera=(0,r["default"])(d["default"].mark(function v(){var a;return d["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,f.connectFrontCamera();case 2:a=b.sent,h=a.getVideoTracks()[0],k(h);case 5:case "end":return b.stop()}},
v)}));c.openBackCamera=(0,r["default"])(d["default"].mark(function x(){var a;return d["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,f.connectBackCamera();case 2:a=b.sent,h=a.getVideoTracks()[0],k(h);case 5:case "end":return b.stop()}},x)}));c.closeCamera=function(){f.disconnect();var a=q["default"].blackTrack();k(a)}}}]);return a}();f["default"]=a},{"./dummy_stream.js":6,"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/classCallCheck":"@babel/runtime/helpers/classCallCheck",
"@babel/runtime/helpers/createClass":"@babel/runtime/helpers/createClass","@babel/runtime/helpers/defineProperty":"@babel/runtime/helpers/defineProperty","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault","@babel/runtime/regenerator":"@babel/runtime/regenerator"}],4:[function(a,c,f){function b(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,
b).enumerable}));c.push.apply(c,d)}return c}function e(a){for(var c=1;c<arguments.length;c++){var d=null!=arguments[c]?arguments[c]:{};c%2?b(d,!0).forEach(function(b){(0,r["default"])(a,b,d[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(d)):b(d).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(d,b))})}return a}function g(a){"undefined"===typeof a.ip&&(a.ip=a.ipAddress,a.port=a.portNumber,a.protocol=a.transport);return a}
c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var d=c(a("@babel/runtime/regenerator")),r=c(a("@babel/runtime/helpers/defineProperty")),k=c(a("@babel/runtime/helpers/asyncToGenerator")),h=c(a("@babel/runtime/helpers/classCallCheck")),q=c(a("@babel/runtime/helpers/createClass"));a=function(){function a(b){var c=this,d=b.peer,e=b.printClear;e=void 0===e?function(){}:e;b=b.printFunc;b=void 0===b?console.log:b;(0,h["default"])(this,
a);this._peer=d;this._clear=e;this._print=b;this.timer=setInterval(this.loop.bind(this),1500);d.addEventListener("connectionstatechange",function(){"closed"==d.connectionState&&c.stop()});d.addEventListener("signalingstatechange",function(){"closed"==d.signalingState&&c.stop()})}(0,q["default"])(a,[{key:"printResult",value:function(){var a=this;this._clear();if(this.localCandidate)if(this.transport){void 0==this.timestamp&&(this.timestamp=this.transport.timestamp);var b=((this.transport.timestamp-
this.timestamp)/1E3).toFixed(3);this._print("connected ".concat(b,"s"));this._print("  local",this.localCandidate.candidateType,this.localCandidate.ip,this.localCandidate.port,this.localCandidate.protocol);this._print("  remote",this.remoteCandidate.candidateType,this.remoteCandidate.ip,this.remoteCandidate.port,this.remoteCandidate.protocol);var c=this.transport.bytesReceived,d=this.transport.bytesSent;b=((c-this._prevRx)/1500).toFixed(1);var e=((d-this._prevTx)/1500).toFixed(1);this._prevRx=c;this._prevTx=
d;c=(c/1E3).toFixed(1).toLocaleString();d=(d/1E3).toFixed(1).toLocaleString();this._print("RX/TX ".concat(b,"/").concat(e," KB total ").concat(c,"/").concat(d," KB"))}else this._print("connected"),this._print("  local",this.localCandidate.candidateType,this.localCandidate.ip,this.localCandidate.port,this.localCandidate.protocol),this._print("  remote",this.remoteCandidate.candidateType,this.remoteCandidate.ip,this.remoteCandidate.port,this.remoteCandidate.protocol);else this._print("try candidate(s):"),
this.candidatePair.forEach(function(b){""==b.localCandidate.ip&&(b.localCandidate.ip="localhost");a._print("  ",b.state,":",b.localCandidate.candidateType,b.localCandidate.ip,b.localCandidate.port,b.localCandidate.protocol,"->",b.remoteCandidate.candidateType,b.remoteCandidate.ip,b.remoteCandidate.port,b.remoteCandidate.protocol)});this.videoCodec?(b=this.videoCodec.mimeType,d=this.video.framesDecoded,e=(1E3*(d-this._prevFrameDecode)/1500).toFixed(1),this._prevFrameDecode=d,d=(this.video.totalDecodeTime/
this.video.framesDecoded*1E3).toFixed(3),c=(this.videoTrack.jitterBufferDelay/this.videoTrack.jitterBufferEmittedCount*1E3).toFixed(3),this._print(b,"FPS ".concat(e),"decode ".concat(d,"ms"),"jitterBufferDelay ".concat(c,"ms"))):this.g48Video&&this.g48Video.framerateMean&&(b=this.g48Video.mediaType,e=this.g48Video.framerateMean.toFixed(1),d=this.g48Video.bytesReceived,this._print(b,"FPS ".concat(e),"bytesReceived ".concat(d)));this.audioCodec?(b=this.audioCodec.mimeType,e=(1E3*this.audio.jitter).toFixed(3),
d=(this.audioTrack.jitterBufferDelay/this.audioTrack.jitterBufferEmittedCount*1E3).toFixed(3),this._print(b,"jitter ".concat(e,"ms"),"jitterBufferDelay ".concat(d,"ms"))):this.g48Audio&&this._print(this.g48Audio.mediaType,"bytesReceived ".concat(this.g48Audio.bytesReceived))}},{key:"_wrapLoop",value:function(){var a=(0,k["default"])(d["default"].mark(function t(){var a=this,b;return d["default"].wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._peer.getStats();case 2:b=c.sent;
this.candidatePair=[];this.remoteCandidate=this.localCandidate=null;b.forEach(function(c){var d=c.type;if("candidate-pair"==d||"candidatepair"==d){d=g(b.get(c.localCandidateId));var f=g(b.get(c.remoteCandidateId)),l=e({},c,{localCandidate:d,remoteCandidate:f});a.candidatePair.push(l);!0===c.nominated&&"succeeded"===c.state&&(a.localCandidate=d,a.remoteCandidate=f,a.transport=b.get(a.localCandidate.transportId))}"video"==c.kind&&0==c.isRemote&&(a.video=c,a.videoTrack=b.get(c.trackId),a.videoCodec=
b.get(c.codecId));"audio"==c.kind&&0==c.isRemote&&(a.audio=c,a.audioTrack=b.get(c.trackId),a.audioCodec=b.get(c.codecId));"video"==c.mediaType&&0==c.isRemote&&(a.g48Video=c);"audio"==c.mediaType&&0==c.isRemote&&(a.g48Audio=c)});if(0!=this.candidatePair.length){c.next=10;break}this.stop("All candiatePair fail. Disconnected.");return c.abrupt("return");case 10:this.printResult();case 11:case "end":return c.stop()}},t,this)}));return function(){return a.apply(this,arguments)}}()},{key:"loop",value:function(){var a=
(0,k["default"])(d["default"].mark(function t(){return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this._wrapLoop();case 3:a.next=9;break;case 5:a.prev=5,a.t0=a["catch"](0),console.error("ConnectionStats error, stop.",a.t0),this.stop("ConnectionStats error");case 9:case "end":return a.stop()}},t,this,[[0,5]])}));return function(){return a.apply(this,arguments)}}()},{key:"stop",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
"Disconnected";clearInterval(this.timer);this._clear();this._print(a)}}],[{key:"hookConnection",value:function(b){var c=b.connectionClient,e=b.logFunction,f=c.connect;c.connect=(0,k["default"])(d["default"].mark(function E(){var b,g,k,h,l,r=arguments;return d["default"].wrap(function(d){for(;;)switch(d.prev=d.next){case 0:b=r.length;g=Array(b);for(k=0;k<b;k++)g[k]=r[k];d.next=3;return f.apply(c,g);case 3:return h=d.sent,e("connecting"),l="",new a({peer:h,printClear:function(){return l=""},printFunc:function(){for(var a=
arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];l+=b.join(" ")+"\n";e(l)}}),d.abrupt("return",h);case 8:case "end":return d.stop()}},E)}))}}]);return a}();f["default"]=a},{"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/classCallCheck":"@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass":"@babel/runtime/helpers/createClass","@babel/runtime/helpers/defineProperty":"@babel/runtime/helpers/defineProperty","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault",
"@babel/runtime/regenerator":"@babel/runtime/regenerator"}],5:[function(a,c,f){function b(){b=(0,g["default"])(e["default"].mark(function k(a){var b,c,f;return e["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b=a.connectionClient;window.addEventListener("orientationchange",function(a){return b.emit("orientationchange",{orientation:window.orientation})},!1);try{document.getElementById("sensor").innerHTML="sensor:deviceorientation"}catch(n){}c=function(){console.warn('Cannot get data from "deviceorientation". Using "devicemotion" to simulate pitch, roll, and yaw.');
try{document.getElementById("sensor").innerHTML="sensor:devicemotion"}catch(x){}var a=Math.sin,c=Math.cos,e=Math.acos,f=Math.atan,g=Math.abs,k=Math.max,h=0,r=1,q=0;window.addEventListener("devicemotion",function(l){if(l.rotationRate.alpha){var p=l.rotationRate;p=(p.beta*r+p.alpha*q)/180*Math.PI*l.interval/1E3;h+=p;h+=3*p}if(l.accelerationIncludingGravity.x){var n=l.accelerationIncludingGravity;l=n.x;p=n.y;n=n.z;n=e(n/k(9.8,l,p,n));l=2>g(l)+g(p)?0:f(l/p)+(0>p?Math.PI:0);r=c(l);q=a(l);b.emit("deviceorientation",
{alpha:(h+l)/Math.PI*180,beta:n*r/Math.PI*180,gamma:-n*q/Math.PI*180})}},!1)};f=setTimeout(c,1500);window.addEventListener("deviceorientation",function(a){clearTimeout(f);b.emit("deviceorientation",{alpha:a.alpha,beta:a.beta,gamma:a.gamma})},!1);case 6:case "end":return e.stop()}},k)}));return b.apply(this,arguments)}c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var e=c(a("@babel/runtime/regenerator")),g=c(a("@babel/runtime/helpers/asyncToGenerator"));
f["default"]={hookConnection:function(a){return b.apply(this,arguments)}}},{"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault","@babel/runtime/regenerator":"@babel/runtime/regenerator"}],6:[function(a,c,f){Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;f["default"]={silenceTrack:function(){var a=new AudioContext,c=a.createOscillator();a=c.connect(a.createMediaStreamDestination());
c.start();return Object.assign(a.stream.getAudioTracks()[0],{enabled:!1})},blackTrack:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=a.width;c=void 0===c?640:c;a=a.height;a=void 0===a?480:a;var f=Object.assign(document.createElement("canvas"),{width:c,height:a});f.getContext("2d").fillRect(0,0,c,a);c=f.captureStream();return Object.assign(c.getVideoTracks()[0],{enabled:!1})},blackSteam:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=a.width;
c=void 0===c?640:c;a=a.height;a=void 0===a?480:a;var f=Object.assign(document.createElement("canvas"),{width:c,height:a});f.getContext("2d").fillRect(0,0,c,a);return f.captureStream()}}},{}],7:[function(a,c,f){var b=a("@babel/runtime/helpers/interopRequireDefault");c=b(a("./connection_client.js"));f=b(a("./helper/connection_stats.js"));var e=b(a("./helper/device_orientation.js"));a=b(a("./helper/camera.js"));window.alakazam={ConnectionClient:c["default"],helper:{ConnectionStats:f["default"],DeviceOrientation:e["default"],
Camera:a["default"]}}},{"./connection_client.js":2,"./helper/camera.js":3,"./helper/connection_stats.js":4,"./helper/device_orientation.js":5,"@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault"}],8:[function(a,c,f){c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var b=c(a("@babel/runtime/regenerator")),e=c(a("@babel/runtime/helpers/asyncToGenerator")),g=c(a("@babel/runtime/helpers/classCallCheck")),
d=c(a("@babel/runtime/helpers/createClass"));a=function(){function a(b,c){(0,g["default"])(this,a);this.host=b;this.prefix=c;this.id=-1}(0,d["default"])(a,[{key:"createConnection",value:function(){var a=(0,e["default"])(b["default"].mark(function u(a){var c,d,e;return b["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:b.prev=0;if(-1!=this.id){b.next=3;break}throw"appRuntime invalid";case 3:return b.next=5,fetch("".concat(this.host,"/api/v1/app-runtimes/").concat(this.id,"/connection"),
{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 5:return c=b.sent,b.next=8,c.json();case 8:return b.abrupt("return",b.sent);case 11:return b.prev=11,b.t0=b["catch"](0),b.next=15,fetch("".concat(this.host,"/api/v1/app-runtimes"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 15:return d=b.sent,b.next=18,d.json();case 18:return e=b.sent,this.id=e.id,b.abrupt("return",e);case 21:case "end":return b.stop()}},u,this,[[0,
11]])}));return function(b){return a.apply(this,arguments)}}()},{key:"setRemoteDescription",value:function(a,b){return fetch("".concat(this.host,"/api/v1/app-runtimes/").concat(a,"/remote-description"),{method:"POST",body:JSON.stringify(b),headers:{"Content-Type":"application/json"}})}},{key:"addIceCandidate",value:function(a,b){return fetch("".concat(this.host,"/api/v1/app-runtimes/").concat(a,"/add-ice-candidate"),{method:"POST",body:JSON.stringify({candidate:b}),headers:{"Content-Type":"application/json"}})}},
{key:"closeConnection",value:function(a){return fetch("".concat(this.host,"/api/v1/app-runtimes/").concat(a,"/connection"),{method:"delete"})}}]);return a}();f["default"]=a},{"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/classCallCheck":"@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass":"@babel/runtime/helpers/createClass","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault",
"@babel/runtime/regenerator":"@babel/runtime/regenerator"}],9:[function(a,c,f){c=a("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;var b=c(a("@babel/runtime/regenerator")),e=c(a("@babel/runtime/helpers/asyncToGenerator")),g=c(a("@babel/runtime/helpers/classCallCheck")),d=c(a("@babel/runtime/helpers/createClass"));a=function(){function a(b,c){(0,g["default"])(this,a);this.host=b+"/"+c;this.id=-1}(0,d["default"])(a,[{key:"createConnection",
value:function(){var a=(0,e["default"])(b["default"].mark(function u(a){var c,d,e;return b["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:b.prev=0;if(-1!=this.id){b.next=3;break}throw"appRuntime invalid";case 3:return b.next=5,fetch("".concat(this.host,"/connections/").concat(this.id),{method:"GET",headers:{"Content-Type":"application/json"}});case 5:return c=b.sent,b.next=8,c.json();case 8:return b.abrupt("return",b.sent);case 11:return b.prev=11,b.t0=b["catch"](0),b.next=15,fetch("".concat(this.host,
"/connections"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 15:return d=b.sent,b.next=18,d.json();case 18:return e=b.sent,this.id=e.id,b.abrupt("return",e);case 21:case "end":return b.stop()}},u,this,[[0,11]])}));return function(b){return a.apply(this,arguments)}}()},{key:"setRemoteDescription",value:function(a,b){return fetch("".concat(this.host,"/connections/").concat(a,"/remote-description"),{method:"POST",body:JSON.stringify(b),headers:{"Content-Type":"application/json"}})}},
{key:"addIceCandidate",value:function(a,b){return fetch("".concat(this.host,"/connections/").concat(a,"/add-ice-candidate"),{method:"POST",body:JSON.stringify({candidate:b}),headers:{"Content-Type":"application/json"}})}},{key:"closeConnection",value:function(a){return fetch("".concat(this.host,"/connections/").concat(a),{method:"delete"})}}]);return a}();f["default"]=a},{"@babel/runtime/helpers/asyncToGenerator":"@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/classCallCheck":"@babel/runtime/helpers/classCallCheck",
"@babel/runtime/helpers/createClass":"@babel/runtime/helpers/createClass","@babel/runtime/helpers/interopRequireDefault":"@babel/runtime/helpers/interopRequireDefault","@babel/runtime/regenerator":"@babel/runtime/regenerator"}],10:[function(a,c,f){Object.defineProperty(f,"__esModule",{value:!0});f["default"]=void 0;f["default"]={listen:function(a){var b=a.connectionClient,c=a.mediaElement,d=a.videoResizePercentage,f=void 0===d?1:d;a=a.disableMouseEvent;var k=void 0===a?!1:a,h=b.send.bind(b),q=1!=
f?function(a){return parseInt(a/f,10)}:function(a){return a},u=0,p=0,n=function(a){u=a.pageX;p=a.pageY;for(var b=c,d=a=0;b;)a+=b.offsetLeft-b.scrollLeft+b.clientLeft,d+=b.offsetTop-b.scrollLeft+b.clientTop,b=b.offsetParent;b=d;a=q(u-a);b=q(p-b);h("mouse_move ".concat(a," ").concat(b))},t=function(a){h("mouse_button left 1")},l=function(a){h("mouse_button left 0")},w=function(a){h("mouse_wheel ".concat(a.deltaX," ").concat(a.deltaY))},E=function(a,c){switch(a.keyCode){case 49:return h("mouse_button left ".concat(c)),
!0;case 51:return h("key_code 188 ".concat(c)),!0;case 52:return h("key_code 91 ".concat(c)),h("mouse_button left ".concat(c)),!0;case 54:return h("key_code 190 ".concat(c)),!0;case 56:return c&&b.connect(),!0}return!1},F=function(a,b){0!=a.keyCode&&(E(a,b)||h("key_code ".concat(a.keyCode," ").concat(b)))},B=function(a){return F(a,1)},y=function(a){return F(a,0)},v=function(a){return Array.from(a).map(function(a){var b=a.identifier,c=q(a.clientX);a=q(a.clientY);return{id:b,x:c,y:a}})},x=function(a){a=
v(a.touches);h("touch_start ".concat(JSON.stringify(a)))},z=function(a){a=v(a.changedTouches);h("touch_move ".concat(JSON.stringify(a)))},G=function(a){a=v(a.touches);h("touch_end ".concat(JSON.stringify(a)))},D=function(a){h("touch_end ".concat(JSON.stringify([])))};k||(c.addEventListener("mousedown",t),document.addEventListener("mousemove",n),document.addEventListener("mouseup",l),document.addEventListener("wheel",w));c.addEventListener("keydown",B);c.addEventListener("keyup",y);c.focus();c.addEventListener("touchstart",
x);document.addEventListener("touchmove",z);document.addEventListener("touchend",G);document.addEventListener("touchcancel",D);return{unlisten:function(){k||(c.removeEventListener("mousedown",t),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",l),document.removeEventListener("wheel",w));c.removeEventListener("keydown",B);c.removeEventListener("keyup",y);c.removeEventListener("touchstart",x);document.removeEventListener("touchmove",z);document.removeEventListener("touchend",
G);document.removeEventListener("touchcancel",D)}}}}},{}],11:[function(a,c,f){c.exports=function(a){if(Array.isArray(a))return a}},{}],12:[function(a,c,f){c.exports=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}},{}],13:[function(a,c,f){c.exports=function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}},{}],14:[function(a,c,f){c.exports=function(a){if(Symbol.iterator in Object(a)||
"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}},{}],15:[function(a,c,f){c.exports=function(a,c){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)){var b=[],d=!0,e=!1,f=void 0;try{for(var h=a[Symbol.iterator](),q;!(d=(q=h.next()).done)&&(b.push(q.value),!c||b.length!==c);d=!0);}catch(u){e=!0,f=u}finally{try{if(!d&&null!=h["return"])h["return"]()}finally{if(e)throw f;}}return b}}},{}],16:[function(a,c,f){c.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance");
}},{}],17:[function(a,c,f){c.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance");}},{}],18:[function(a,c,f){function b(a,f){c.exports=b=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return b(a,f)}c.exports=b},{}],19:[function(a,c,f){a=function(a){function b(a,b,c,e){b=Object.create((b&&b.prototype instanceof d?b:d).prototype);e=new l(e||[]);b._invoke=u(a,c,e);return b}function c(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(O){return{type:"throw",
arg:O}}}function d(){}function f(){}function k(){}function h(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function q(a){function b(d,e,f,m){d=c(a[d],a,e);if("throw"===d.type)m(d.arg);else{var g=d.arg;return(d=g.value)&&"object"===typeof d&&B.call(d,"__await")?Promise.resolve(d.__await).then(function(a){b("next",a,f,m)},function(a){b("throw",a,f,m)}):Promise.resolve(d).then(function(a){g.value=a;f(g)},function(a){return b("throw",a,f,m)})}}var d;this._invoke=
function(a,c){function e(){return new Promise(function(d,e){b(a,c,d,e)})}return d=d?d.then(e,e):e()}}function u(a,b,d){var e=D;return function(f,m){if(e===L)throw Error("Generator is already running");if(e===J){if("throw"===f)throw m;return E()}d.method=f;for(d.arg=m;;){if(f=d.delegate)if(f=p(f,d)){if(f===A)continue;return f}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if(e===D)throw e=J,d.arg;d.dispatchException(d.arg)}else"return"===d.method&&d.abrupt("return",d.arg);e=
L;f=c(a,b,d);if("normal"===f.type){e=d.done?J:K;if(f.arg===A)continue;return{value:f.arg,done:d.done}}"throw"===f.type&&(e=J,d.method="throw",d.arg=f.arg)}}}function p(a,b){var d=a.iterator[b.method];if(d===y){b.delegate=null;if("throw"===b.method){if(a.iterator["return"]&&(b.method="return",b.arg=y,p(a,b),"throw"===b.method))return A;b.method="throw";b.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}d=c(d,a.iterator,b.arg);if("throw"===d.type)return b.method="throw",
b.arg=d.arg,b.delegate=null,A;d=d.arg;if(!d)return b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,A;if(d.done)b[a.resultName]=d.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=y);else return d;b.delegate=null;return A}function n(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]);2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]);this.tryEntries.push(b)}function t(a){var b=a.completion||{};b.type="normal";delete b.arg;a.completion=b}function l(a){this.tryEntries=
[{tryLoc:"root"}];a.forEach(n,this);this.reset(!0)}function w(a){if(a){var b=a[x];if(b)return b.call(a);if("function"===typeof a.next)return a;if(!isNaN(a.length)){var c=-1;b=function C(){for(;++c<a.length;)if(B.call(a,c))return C.value=a[c],C.done=!1,C;C.value=y;C.done=!0;return C};return b.next=b}}return{next:E}}function E(){return{value:y,done:!0}}var F=Object.prototype,B=F.hasOwnProperty,y,v="function"===typeof Symbol?Symbol:{},x=v.iterator||"@@iterator",z=v.asyncIterator||"@@asyncIterator",G=
v.toStringTag||"@@toStringTag";a.wrap=b;var D="suspendedStart",K="suspendedYield",L="executing",J="completed",A={};v={};v[x]=function(){return this};var H=Object.getPrototypeOf;(H=H&&H(H(w([]))))&&H!==F&&B.call(H,x)&&(v=H);var I=k.prototype=d.prototype=Object.create(v);f.prototype=I.constructor=k;k.constructor=f;k[G]=f.displayName="GeneratorFunction";a.isGeneratorFunction=function(a){return(a="function"===typeof a&&a.constructor)?a===f||"GeneratorFunction"===(a.displayName||a.name):!1};a.mark=function(a){Object.setPrototypeOf?
Object.setPrototypeOf(a,k):(a.__proto__=k,G in a||(a[G]="GeneratorFunction"));a.prototype=Object.create(I);return a};a.awrap=function(a){return{__await:a}};h(q.prototype);q.prototype[z]=function(){return this};a.AsyncIterator=q;a.async=function(c,d,e,f){var g=new q(b(c,d,e,f));return a.isGeneratorFunction(d)?g:g.next().then(function(a){return a.done?a.value:g.next()})};h(I);I[G]="Generator";I[x]=function(){return this};I.toString=function(){return"[object Generator]"};a.keys=function(a){var b=[],
c;for(c in a)b.push(c);b.reverse();return function C(){for(;b.length;){var c=b.pop();if(c in a)return C.value=c,C.done=!1,C}C.done=!0;return C}};a.values=w;l.prototype={constructor:l,reset:function(a){this.next=this.prev=0;this.sent=this._sent=y;this.done=!1;this.delegate=null;this.method="next";this.arg=y;this.tryEntries.forEach(t);if(!a)for(var b in this)"t"===b.charAt(0)&&B.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=y)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===
a.type)throw a.arg;return this.rval},dispatchException:function(a){function b(b,d){f.type="throw";f.arg=a;c.next=b;d&&(c.method="next",c.arg=y);return!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;0<=d;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=B.call(e,"catchLoc"),h=B.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<
e.catchLoc)return b(e.catchLoc,!0)}else if(h){if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else throw Error("try statement without catch or finally");}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;0<=c;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&B.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);c=e?e.completion:{};c.type=a;c.arg=b;return e?(this.method="next",this.next=e.finallyLoc,A):
this.complete(c)},complete:function(a,b){if("throw"===a.type)throw a.arg;"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b);return A},finish:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),t(c),A}},"catch":function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];
if(c.tryLoc===a){a=c.completion;if("throw"===a.type){var d=a.arg;t(c)}return d}}throw Error("illegal catch attempt");},delegateYield:function(a,b,c){this.delegate={iterator:w(a),resultName:b,nextLoc:c};"next"===this.method&&(this.arg=y);return A}};return a}("object"===typeof c?c.exports:{});try{regeneratorRuntime=a}catch(b){Function("r","regeneratorRuntime = r")(a)}},{}],"@babel/runtime/helpers/asyncToGenerator":[function(a,c,f){function b(a,b,c,f,k,h,q){try{var d=a[h](q),e=d.value}catch(n){c(n);
return}d.done?b(e):Promise.resolve(e).then(f,k)}c.exports=function(a){return function(){var c=this,d=arguments;return new Promise(function(e,f){function g(a){b(r,e,f,g,k,"next",a)}function k(a){b(r,e,f,g,k,"throw",a)}var r=a.apply(c,d);g(void 0)})}}},{}],"@babel/runtime/helpers/classCallCheck":[function(a,c,f){c.exports=function(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function");}},{}],"@babel/runtime/helpers/createClass":[function(a,c,f){function b(a,b){for(var c=
0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}c.exports=function(a,c,d){c&&b(a.prototype,c);d&&b(a,d);return a}},{}],"@babel/runtime/helpers/defineProperty":[function(a,c,f){c.exports=function(a,c,f){c in a?Object.defineProperty(a,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[c]=f;return a}},{}],"@babel/runtime/helpers/getPrototypeOf":[function(a,c,f){function b(a){c.exports=b=Object.setPrototypeOf?
Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return b(a)}c.exports=b},{}],"@babel/runtime/helpers/inherits":[function(a,c,f){var b=a("./setPrototypeOf");c.exports=function(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,writable:!0,configurable:!0}});c&&b(a,c)}},{"./setPrototypeOf":18}],"@babel/runtime/helpers/interopRequireDefault":[function(a,
c,f){c.exports=function(a){return a&&a.__esModule?a:{"default":a}}},{}],"@babel/runtime/helpers/possibleConstructorReturn":[function(a,c,f){var b=a("../helpers/typeof"),e=a("./assertThisInitialized");c.exports=function(a,c){return!c||"object"!==b(c)&&"function"!==typeof c?e(a):c}},{"../helpers/typeof":"@babel/runtime/helpers/typeof","./assertThisInitialized":13}],"@babel/runtime/helpers/slicedToArray":[function(a,c,f){var b=a("./arrayWithHoles"),e=a("./iterableToArrayLimit"),g=a("./nonIterableRest");
c.exports=function(a,c){return b(a)||e(a,c)||g()}},{"./arrayWithHoles":11,"./iterableToArrayLimit":15,"./nonIterableRest":16}],"@babel/runtime/helpers/toConsumableArray":[function(a,c,f){var b=a("./arrayWithoutHoles"),e=a("./iterableToArray"),g=a("./nonIterableSpread");c.exports=function(a){return b(a)||e(a)||g()}},{"./arrayWithoutHoles":12,"./iterableToArray":14,"./nonIterableSpread":17}],"@babel/runtime/helpers/typeof":[function(a,c,f){function b(a){b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?
function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return b(a)}function e(a){"function"===typeof Symbol&&"symbol"===b(Symbol.iterator)?c.exports=e=function(a){return b(a)}:c.exports=e=function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":b(a)};return e(a)}c.exports=e},{}],"@babel/runtime/regenerator":[function(a,c,f){c.exports=a("regenerator-runtime")},{"regenerator-runtime":19}]},
{},[7]);
